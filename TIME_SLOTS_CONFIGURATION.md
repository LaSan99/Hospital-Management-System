# Time Slots Configuration Guide

## Overview
Time slots are automatically generated by the backend based on configurable settings. The system checks for existing appointments and only shows available slots.

## Configuration Location
**File:** `backend/routes/appointments.js`  
**Function:** `GET /availability/:doctorId` (lines 296-345)

## Current Settings

```javascript
const startHour = 9;        // Start time: 9 AM
const endHour = 17;         // End time: 5 PM (17:00)
const slotDuration = 30;    // Slot duration in minutes
const lunchStart = 13;      // Lunch break start (1 PM)
const lunchEnd = 14;        // Lunch break end (2 PM)
```

## How to Customize

### 1. Change Working Hours
```javascript
const startHour = 8;   // Start at 8 AM
const endHour = 18;    // End at 6 PM
```

### 2. Change Slot Duration
```javascript
const slotDuration = 15;   // 15-minute slots
const slotDuration = 30;   // 30-minute slots (default)
const slotDuration = 60;   // 1-hour slots
```

### 3. Modify Lunch Break
```javascript
// Option A: Change lunch break time
const lunchStart = 12;     // 12 PM
const lunchEnd = 13;       // 1 PM

// Option B: Disable lunch break (comment out lines 311-313)
// if (hour >= lunchStart && hour < lunchEnd) {
//   continue;
// }
```

### 4. Add Multiple Breaks
```javascript
// Add morning break
if (hour === 10 && minute === 30) {
  continue; // Skip 10:30 AM slot
}

// Add afternoon break
if (hour === 15 && minute === 0) {
  continue; // Skip 3:00 PM slot
}
```

### 5. Weekend/Holiday Handling
Add this before the slot generation loop:

```javascript
// Check if date is weekend
const selectedDate = new Date(date);
const dayOfWeek = selectedDate.getDay();

if (dayOfWeek === 0 || dayOfWeek === 6) {
  // Sunday = 0, Saturday = 6
  return res.json({
    success: true,
    data: {
      availableSlots: [],
      count: 0,
      message: 'No appointments available on weekends'
    }
  });
}
```

## Example Configurations

### Example 1: Full Day (8 AM - 8 PM, 1-hour slots)
```javascript
const startHour = 8;
const endHour = 20;
const slotDuration = 60;
const lunchStart = 12;
const lunchEnd = 13;
```
**Result:** 8:00, 9:00, 10:00, 11:00, 1:00, 2:00, 3:00, 4:00, 5:00, 6:00, 7:00

### Example 2: Half Day (9 AM - 1 PM, 15-minute slots)
```javascript
const startHour = 9;
const endHour = 13;
const slotDuration = 15;
// Comment out lunch break
```
**Result:** 9:00, 9:15, 9:30, 9:45, 10:00, 10:15... 12:45

### Example 3: Split Shift (Morning & Evening)
```javascript
const morningStart = 9;
const morningEnd = 12;
const eveningStart = 17;
const eveningEnd = 20;
const slotDuration = 30;

// Generate morning slots
for (let hour = morningStart; hour < morningEnd; hour++) {
  // ... slot generation logic
}

// Generate evening slots
for (let hour = eveningStart; hour < eveningEnd; hour++) {
  // ... slot generation logic
}
```

## Testing Changes

1. **Restart the backend server** after making changes:
   ```bash
   cd backend
   npm start
   ```

2. **Test in the frontend:**
   - Navigate to the Book Appointment page
   - Select a date
   - Verify the time slots appear correctly

3. **Check for conflicts:**
   - Book an appointment
   - Try to book the same slot again
   - Verify it's no longer available

## Advanced: Doctor-Specific Schedules

To implement different schedules for different doctors, you could:

1. **Add schedule to Doctor model:**
   ```javascript
   schedule: {
     startHour: { type: Number, default: 9 },
     endHour: { type: Number, default: 17 },
     slotDuration: { type: Number, default: 30 },
     lunchStart: { type: Number, default: 13 },
     lunchEnd: { type: Number, default: 14 },
     workingDays: [1, 2, 3, 4, 5] // Monday to Friday
   }
   ```

2. **Fetch doctor and use their schedule:**
   ```javascript
   const doctor = await User.findById(doctorId);
   const startHour = doctor.schedule?.startHour || 9;
   const endHour = doctor.schedule?.endHour || 17;
   // ... use doctor's settings
   ```

## Troubleshooting

**No slots showing?**
- Check if `startHour < endHour`
- Verify the date is not in the past
- Check if all slots are already booked
- Look for console errors in backend

**Slots ending at wrong time?**
- Verify `slotDuration` is set correctly
- Check the end time calculation logic

**Lunch break not working?**
- Ensure `lunchStart < lunchEnd`
- Verify the if condition is not commented out

## Notes

- All times use **24-hour format** (0-23)
- Slot duration is in **minutes**
- The system automatically excludes booked slots
- Changes require **server restart** to take effect
